<!doctype html>
<!-- Conditional comment for mobile ie7 blogs.msdn.com/b/iemobile/ -->
<!--[if IEMobile 7 ]>    <html class="no-js iem7" lang="en" ng-app="EZWApp" id="ng-app"> <![endif]-->
<!--[if (gt IEMobile 7)|!(IEMobile)]><!--> <html class="no-js" lang="en" ng-app="EZWApp" id="ng-app"> <!--<![endif]-->

    <head>
        <meta charset="utf-8">

        <title>SWZ Playground</title>
        <meta name="description" content="">

        <!-- Mobile viewport optimization h5bp.com/ad -->
        <meta name="HandheldFriendly" content="True">
        <meta name="MobileOptimized" content="320">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Home screen icon  Mathias Bynens mathiasbynens.be/notes/touch-icons -->
        <!-- For iPhone 4 with high-resolution Retina display: -->
        <link rel="apple-touch-icon-precomposed" sizes="114x114" href="img/h/apple-touch-icon.png">
        <!-- For first-generation iPad: -->
        <link rel="apple-touch-icon-precomposed" sizes="72x72" href="img/m/apple-touch-icon.png">
        <!-- For non-Retina iPhone, iPod Touch, and Android 2.1+ devices: -->
        <link rel="apple-touch-icon-precomposed" href="img/l/apple-touch-icon-precomposed.png">
        <!-- For nokia devices: -->
        <link rel="shortcut icon" href="img/l/apple-touch-icon.png">

        <!-- iOS web app, delete if not needed. https://github.com/h5bp/mobile-boilerplate/issues/94 -->
        <!-- <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black"> -->
        <!-- <script>(function(){var a;if(navigator.platform==="iPad"){a=window.orientation!==90||window.orientation===-90?"img/startup-tablet-landscape.png":"img/startup-tablet-portrait.png"}else{a=window.devicePixelRatio===2?"img/startup-retina.png":"img/startup.png"}document.write('<link rel="apple-touch-startup-image" href="'+a+'"/>')})()</script> -->

        <!-- The script prevents links from opening in mobile safari. https://gist.github.com/1042026 -->
        <!-- <script>(function(a,b,c){if(c in b&&b[c]){var d,e=a.location,f=/^(a|html)$/i;a.addEventListener("click",function(a){d=a.target;while(!f.test(d.nodeName))d=d.parentNode;"href"in d&&(d.href.indexOf("http")||~d.href.indexOf(e.host))&&(a.preventDefault(),e.href=d.href)},!1)}})(document,window.navigator,"standalone")</script> -->

        <!-- Mobile IE allows us to activate ClearType technology for smoothing fonts for easy reading -->
        <meta http-equiv="cleartype" content="on">

        <!-- more tags for your 'head' to consider h5bp.com/d/head-Tips -->

        <link href="css/main.css" media="screen">

        <!-- Bootstrap -->
        <!-- <link rel="stylesheet" href="//netdna.bootstrapcdn.com/twitter-bootstrap/2.3.1/css/bootstrap-combined.min.css"> -->
        <link href="bootstrap/css/bootstrap.min.css" rel="stylesheet" media="screen">
        <link href="bootstrap/css/bootstrap-responsive.min.css" rel="stylesheet" media="screen">

        <!-- Bootstrap-switch -->
        <link rel="stylesheet" href="bootstrap-switch/static/stylesheets/bootstrapSwitch.css">

        <!-- Main Stylesheet -->
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/main.css">

        <!-- All JavaScript at the bottom, except for Modernizr which enables HTML5 elements & feature detects -->
        <script src="lib/modernizr-2.0.6.min.js"></script>
    </head>

    <body data-spy="scroll" data-target="#top-nav" ng-controller="EZWCtrl" chunk-stalker-nav-bar="pngEditedImage.chunks">
        <div id="top-nav" class="navbar navbar-fixed-top">
            <div class="navbar-inner" style="min-height:0">
                <div class="container">
                    <a class="brand" href="#">EZW</a>
                    <ul class="nav">
                        <li><a href="#FileInfoDiv">File info</a></li>
                        <li class="divider-vertical"></li>
                        <li><a href="#SrcImageDiv">Source</a></li>
                        <li><a href="#TransformedImageDiv">Transformed</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div id="wrap" style="padding-bottom: 134px">
            <header class="hero-unit">
                <h1>EZW Playground</h1>
                <p>A playground to experiment with image compression algorithms</p>
            </header>
            <div class="container-fluid">
                <div class="row-fluid">
                    <nav class="span2 visible-tablet visible-desktop">
                        <ul class="nav nav-list navbar-inner affix">
                            <li class="nav-header">Jump to</li>
                            <li><a href="#FileInfoDiv">File info</a></li>
                            <li><a href="#SrcImageDiv">Source image</a></li>
                            <li><a href="#TransformedImageDiv">Transformed image</a></li>
                        </ul>
                    </nav>

                    <div id="main" class="span10" role="main">
                        <div class="row-fluid">
                            <div id="FileInfoDiv" class="span3">
                                <h2>File info</h2>
                                <p>Name: <strong id="srcFileNameValue">{{srcFile.name}}</strong></p>
                                <p>Type: <strong id="srcFileTypeValue">{{srcFile.type}}</strong></p>
                                <p>Size: <strong id="srcFileSizeValue">{{srcFile.size}}</strong> bytes</p>
                                <p>Last modified: <strong id="srcFileLastModifiedDateValue">{{srcFile.lastModifiedDate}}</strong></p>
                            </div>
                            <div id="SrcImageInfoDiv" class="span3">
                                <h2>Image info</h2>
                                <p>Height: <strong id="srcDataHeightValue">{{srcData.height || '--'}}</strong> pixels</p>
                                <p>Width: <strong id="srcDataWidthValue">{{srcData.width || '--'}}</strong> pixels</p>
                                <p>Uncompressed size: <strong id="srcDataSizeValue">{{srcData.data.length?(srcData.data.length * 4):'--'}}</strong> bytes</p>
                                <p>Compress ratio: <strong id="srcDataCompressRatio">{{srcData.data.length?'1 : ' + (srcData.data.length * 4 / srcFile.size):'--'}}</strong></p>
                            </div>
                        </div>

                        <div id="ImagesDiv" class="row-fluid">
                            <div id="SrcImageDiv" class="span6">
                                <h2>Source image</h2>
                                <div id="LoadFileDiv">
                                    <form name="file-form">
                                        <fieldset>
                                            <legend class="hidden">Source image</legend>
                                            <label for="image-file"><i id="image-file-icon" tooltip="'Select a file to load'" class="icon-folder-open"></i></label>
                                            <div class="hidden"><input type="file" id="image-file" name="image-file" multiple=""/></div>
                                            <label><i id="get-example-file-icon" class="icon-lenna" tooltip="'Load example image'" ng-click="loadLenna()"></i></label>
                                        </fieldset>
                                    </form>
                                </div>
                                <div id="file-drag">
                                    <canvas id="src-image-canvas" width="100" height="100" class="img-polaroid" >Sorry, your browser does not support the &lt;canvas&gt; element.</canvas>
                                </div>
                            </div>

                            <div id="EditedImageDiv" class="span6">
                                <h2>Transformed image</h2>
                                <div>
                                    <form>
                                        <fieldset>
                                            <legend class="hidden"></legend>
                                            <label><a><i id="save-file-icon" class="icon-download" tooltip="'Save edited image (not yet available)'"></i></a></label>
                                        </fieldset>
                                    </form>
                                </div>
                                <img id="edited-image-img" alt="Edited Image" width="{{srcEditedImage.width}}" height="{{srcEditedImage.height}}" ng-src="{{srcEditedImage.imgSrc}}" class="img-polaroid" />
                            </div>

                        </div><!-- /#ImagesDiv -->

                        <div id="RawSrcDataDiv" class="row-fuid">
                            <div class="span12">
                                <h2>Source data</h2>
                                <ul class="nav nav-tabs" id="src-components-tabs">
                                    <li class="active"><a href="#src-R-table" data-toggle="tab">red channel</a></li>
                                    <li><a href="#src-G-table" data-toggle="tab">green channel</a></li>
                                    <li><a href="#src-B-table" data-toggle="tab">blue channel</a></li>
                                </ul>
                                <div class="tab-content">
                                    <div ng-repeat="component in ['R','G','B']" class="tab-pane{{component==='R'?' active':''}}" id="src-{{component}}-table">
                                        <table>
                                            <thead>
                                                <tr>
                                                    <th></th>
                                                    <th ng-repeat="i in srcData[component][0] track by $index">{{$index}}</th>
                                                </tr>
                                            </thead>
                                            <tbody>
                                                <tr ng-repeat="pixelRow in srcData[component] track by $index">
                                                    <th>{{$index}}</th>
                                                    <td ng-repeat="pixel in pixelRow track by $index" style="background-color: rgb({{pixel}},{{pixel}},{{pixel}})"></td>
                                                </tr>
                                            </tbody>
                                        </table>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div id="RawTransformedDataDiv" class="row-fuid">
                            <div class="span12">
                                <h2>Transformed data</h2>
                            </div>
                        </div>
                        <div class="clearfix"></div>
                    </div><!-- /#main -->
                </div> <!-- /.row-fluid -->
            </div> <!-- /.container-fluid -->
        </div>

        <footer class="navbar navbar-fixed-bottom">
            <hr/>
            <div id="status">
                <p>Status: <strong class="{{status.class}}">{{status.message}}</strong></p>
            </div>
            <hr/>
            <p class="text-center"><small>&copy; 2013 ag</small></p>
            <p class="text-center"><small><a href="http://glyphicons.com">Glyphicons Free</a> licensed under <a href="http://creativecommons.org/licenses/by/3.0/">CC BY 3.0</a>.</small></p>
        </footer>

        <!-- JavaScript at the bottom for fast page loading -->
        <!-- Grab Google CDN's jQuery, with a protocol relative URL; fall back to local if necessary -->
        <!-- AG 2013-06-12: bootstrap-switch requires jquery >= 1.9.0 -->
        <script src="//ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
        <script>window.jQuery || document.write('<script src="lib/jquery-1.9.0.min.js"><\/script>');</script>

        <!-- Grab Google CDN's AngularJs, with a protocol relative URL; fall back to local if necessary -->
        <!-- Angular 1.0.* doesn't support $http...responseType. See https://github.com/angular/angular.js/issues/1013 -->
        <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.1.5/angular.min.js"></script>
        <script>window.angular || document.write('<script src="js/libs/angularjs-1.1.5/angular.min.js"><\/script>');</script>

        <!-- Bootstrap -->
        <!--<script src="http://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/2.3.1/js/bootstrap.min.js"></script>-->
        <script src="bootstrap/js/bootstrap.min.js"></script>

        <!-- Bootstrap-switch -->
        <script src="bootstrap-switch/static/js/bootstrapSwitch.js"></script>
        <!-- <script src="//cdnjs.cloudflare.com/ajax/libs/bootstrap-switch/1.3/bootstrapSwitch.min.js"></script>  // from cdnjs.com -->

        <!-- scripts concatenated and minified via ant build script-->
        <script src="js/helper.js"></script>
        <script src="js/app.js"></script>
        <script src="js/controllers.js"></script>
        <script src="js/directives.js"></script>
        <script src="js/filters.js"></script>
        <script src="js/services.js"></script>
        <script src="js/pngimage.js"></script>
        <script src="js/crc.js"></script>
        <script>
            // I need this script section to work-around a NB formatting bug:
            // https://netbeans.org/bugzilla/show_bug.cgi?id=229658
            // An onchange="blahblah" attribute breaks the javascript
            //  indentation level
            ;
        </script>
        <script>
            function initFileSelector() {
                var fileselect = $("#image-file")[0];
                // file select
                fileselect.addEventListener("change", fileSelectHandler, false);
            }

            function initDragAndDrop() {
                var filedrag = $("#file-drag")[0];
                // is XHR2 available?
                var xhr = new XMLHttpRequest();
                if (xhr.upload) {
                    // file drop
                    filedrag.addEventListener("dragover", fileDragHover, false);
                    filedrag.addEventListener("dragleave", fileDragHover, false);
                    filedrag.addEventListener("drop", fileSelectHandler, false);
                    filedrag.style.display = "block";
                }
            }

            function fileDragHover(e) {
                e.stopPropagation();
                e.preventDefault();
                e.target.className = (e.type === "dragover" ? "hover" : "");
            }

            /**
             * File selection
             * @param {Event} e <tt>change</tt> event fired from the
             *      <tt>input type="file"</tt> or <tt>mouse</tt> event fired
             *      from the drag-and-drop target div.
             */
            function fileSelectHandler(e) {
                // cancel event and hover styling
                fileDragHover(e);
                // fetch FileList object:
                // - if change event: e.target.files
                // - if mouse event: e.dataTransfer.files
                var files = e.target.files || e.dataTransfer.files;

                // Set controller's file
                angular.element($('#main')).scope().setFile(files[0]);
            }

            // Initialization -------------------------------------------------
            $(function() {
                if (window.File && window.FileList && window.FileReader) {
                    initFileSelector();
                    initDragAndDrop();
                }
//                $('#src-component-tabs a[href="src-R-table"]').tab('show');
            });

//            (function() {
//                var canvas = document.getElementById('canvas2');
//                var context = canvas.getContext('2d');
//                var base_img = new Image();
//                base_img.src = 'img/uni-logo.jpg';
//                base_img.onload = function() {
//                    context.drawImage(base_img, 100, 100);
//                };
//            })();
        </script>
        <!-- end scripts-->

        <!-- Debugger - remove for production -->
        <!-- <script src="https://getfirebug.com/firebug-lite.js"></script> -->
    </body>
</html>
